findTransformForHomogeneity <- function(dependentVariable, independentVariable, dataset){    install.packages("lawstat");    library(lawstat);            D <- as.data.frame(dataset);        eval(parse(text = paste("D$",independentVariable," = ","as.factor(D$",independentVariable,")",sep="")));    transformations = c("sqrt", "cube", "reciprocal", "log");        dependentVariableData = eval(parse(text = paste("D$", dependentVariable, sep="")));        type = "none";        for(i in 1:length(transformations))    {    	if(transformations[i] == "sqrt")    	{	            eval(parse(text = paste("D$",dependentVariable," = sqrt(dependentVariableData)")));                        if(length(unique(eval(parse(text = paste("D$",dependentVariable,sep=""))))) != 1)            {                result <- eval(parse(text = paste("levene.test(D$",dependentVariable,", D$", independentVariable, ")", sep="")));                                if(!is.nan(result$p.value))                    {                    if(result$p.value > 0.05)                    {                        type = "sqrt";                    }                    else                    {                        type = "none";                        break;                    }                }            }                		if(type!="none")    		    break;    	}    	if(transformations[i] == "cube")    	{	            eval(parse(text = paste("D$",dependentVariable," = dependentVariableData^(1/3)")));                        if(length(unique(eval(parse(text = paste("D$",dependentVariable,sep=""))))) != 1)            {                result <- eval(parse(text = paste("levene.test(D$",dependentVariable,", D$", independentVariable, ")", sep="")));                                if(!is.nan(result$p.value))                    {                    if(result$p.value > 0.05)                    {                        type = "cube";                    }                    else                    {                        type = "none";                        break;                    }                }            }                		if(type!="none")    		    break;    	}    	if(transformations[i] == "reciprocal")    	{	            eval(parse(text = paste("D$",dependentVariable," = 1/dependentVariableData")));                        if(length(unique(eval(parse(text = paste("D$",dependentVariable,sep=""))))) != 1)            {                result <- eval(parse(text = paste("levene.test(D$",dependentVariable,", D$", independentVariable, ")", sep="")));                                if(!is.nan(result$p.value))                    {                    if(result$p.value > 0.05)                    {                        type = "reciprocal";                    }                    else                    {                        type = "none";                        break;                    }                }            }                		if(type!="none")    		    break;    	}    	if(transformations[i] == "log")    	{	            eval(parse(text = paste("D$",dependentVariable," = log(dependentVariableData)")));                        if(length(unique(eval(parse(text = paste("D$",dependentVariable,sep=""))))) != 1)            {                result <- eval(parse(text = paste("levene.test(D$",dependentVariable,", D$", independentVariable, ")", sep="")));                                if(!is.nan(result$p.value))                    {                    if(result$p.value > 0.05)                    {                        type = "log";                    }                    else                    {                        type = "none";                        break;                    }                }            }                		if(type!="none")    		    break;    	}    }        list(type = type);}